{{- if .Values.openbao.enabled }}
{{- if .Values.openbao.radarrSecret.enabled }}
---
# VaultStaticSecret for Radarr API key from OpenBao KV store
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: {{ include "program-director.fullname" . }}-radarr
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "program-director.labels" . | nindent 4 }}
spec:
  # Reference to VaultAuth resource
  vaultAuthRef: {{ include "program-director.fullname" . }}-auth

  # KV v2 secret engine mount path
  mount: {{ .Values.openbao.radarrSecret.mount }}

  # Path to the secret within the mount
  path: {{ .Values.openbao.radarrSecret.path }}

  # KV version (kv-v2 for versioned secrets)
  type: kv-v2

  # Destination Kubernetes Secret configuration
  destination:
    create: true
    name: {{ .Values.openbao.radarrSecret.secretName | default (printf "%s-radarr-secret" (include "program-director.fullname" .)) }}
    type: Opaque
    overwrite: true

  # How often to refresh the secret from OpenBao
  refreshAfter: {{ .Values.openbao.radarrSecret.refreshAfter | default "1h" }}
{{- end }}

{{- if .Values.openbao.sonarrSecret.enabled }}
---
# VaultStaticSecret for Sonarr API key from OpenBao KV store
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: {{ include "program-director.fullname" . }}-sonarr
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "program-director.labels" . | nindent 4 }}
spec:
  # Reference to VaultAuth resource
  vaultAuthRef: {{ include "program-director.fullname" . }}-auth

  # KV v2 secret engine mount path
  mount: {{ .Values.openbao.sonarrSecret.mount }}

  # Path to the secret within the mount
  path: {{ .Values.openbao.sonarrSecret.path }}

  # KV version (kv-v2 for versioned secrets)
  type: kv-v2

  # Destination Kubernetes Secret configuration
  destination:
    create: true
    name: {{ .Values.openbao.sonarrSecret.secretName | default (printf "%s-sonarr-secret" (include "program-director.fullname" .)) }}
    type: Opaque
    overwrite: true

  # How often to refresh the secret from OpenBao
  refreshAfter: {{ .Values.openbao.sonarrSecret.refreshAfter | default "1h" }}
{{- end }}
{{- end }}
